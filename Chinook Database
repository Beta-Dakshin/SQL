#Here I queried the database chinook, to better understand the data. 

#1: Show customers not in the US
SELECT 
CustomerId,
FirstName || ' ' || LastName AS FullName,
Country
FROM customers
WHERE Country <> 'USA';

#2: Show only customers from Brazil
SELECT 
CustomerId,
FirstName || ' ' || LastName AS FullName,
Country
FROM customers
WHERE Country = 'Brazil';

#3: Invoices of customers from Brazil
SELECT 
c.FirstName || ' ' || c.LastName AS FullName,
i.InvoiceId,
i.InvoiceDate,
i.BillingCountry
FROM invoices i
JOIN customers c ON i.CustomerId = c.CustomerId
WHERE c.Country = 'Brazil';

#4: Employees who are Sales Agents
SELECT 
EmployeeId,
FirstName || ' ' || LastName AS FullName,
Title
FROM employees
WHERE Title LIKE '%Sales%';

#5: Distinct billing countries from Invoice
SELECT DISTINCT BillingCountry
FROM invoices
ORDER BY BillingCountry;

#6:  Invoice total, customer name, country, and sales agent
SELECT 
i.InvoiceId,
i.Total AS InvoiceTotal,
c.FirstName || ' ' || c.LastName AS CustomerName,
c.Country,
e.FirstName || ' ' || e.LastName AS SalesAgent
FROM invoices i
JOIN customers c ON i.CustomerId = c.CustomerId
JOIN employees e ON c.SupportRepId = e.EmployeeId;

#7: How many invoices in 2009
SELECT COUNT(*) AS InvoiceCount2009
FROM invoices
WHERE strftime('%Y', InvoiceDate) = '2009';

#8: Total sales for 2009
SELECT SUM(Total) AS TotalSales2009
FROM invoices
WHERE strftime('%Y', InvoiceDate) = '2009';

#9: All tracks with album name, media type, and genre
SELECT 
t.TrackId,
t.Name AS TrackName,
al.Title AS AlbumName,
mt.Name AS MediaType,
g.Name AS Genre
FROM tracks t
JOIN albums al ON t.AlbumId = al.AlbumId
JOIN media_types mt ON t.MediaTypeId = mt.MediaTypeId
JOIN genres g ON t.GenreId = g.GenreId;

#10: Total sales made by each sales agent
SELECT 
e.FirstName || ' ' || e.LastName AS SalesAgent,
SUM(i.Total) AS TotalSales
FROM invoices i
JOIN customers c ON i.CustomerId = c.CustomerId
JOIN employees e ON c.SupportRepId = e.EmployeeId
GROUP BY SalesAgent
ORDER BY TotalSales DESC;

#11: Which sales agent made the most dollars in sales in 2009
SELECT 
e.FirstName || ' ' || e.LastName AS SalesAgent,
SUM(i.Total) AS TotalSales2009
FROM invoices i
JOIN customers c ON i.CustomerId = c.CustomerId
JOIN employees e ON c.SupportRepId = e.EmployeeId
WHERE strftime('%Y', i.InvoiceDate) = '2009'
GROUP BY SalesAgent
ORDER BY TotalSales2009 DESC
LIMIT 1;

